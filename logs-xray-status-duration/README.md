# Log2Timeline

多 Trace ID、分阶段的 JFrog Xray 日志时序分析工具。

## 项目简介

Log2Timeline 能够自动解析 Xray 日志，提取每个 trace id 的各个处理阶段（如 indexer、persist、analysis、ca、exposure）的起止时间和耗时，并以表格形式输出，便于定位瓶颈和异常。

## 主要特性

- 支持多 trace id 同时分析
- 严格 artifact 匹配，trace id 提取精准
- 支持多种阶段结束标志，兼容不同日志格式
- 输出各阶段起止时间、耗时、完整表格
- 适配 Xray 日志的多种实际场景

## 使用方法

1. 准备好已归档的 Xray 日志（推荐配合 [Bundle2Logs](../bundle2logs) 使用）。
2. 运行脚本：

   ```bash
   python3 xray_scan_timeline_traceid.py <日志目录或日志文件> <扫描的制品名称>
   ```

3. 查看输出的 trace id 阶段表格。

## 输出示例

```
All trace ids: ['99d88c9952e83ed2', '280a4d12ec79bd7e']
# Trace ID: 99d88c9952e83ed2
| 阶段      | 起始时间                 | 结束时间                 | 耗时     |
|-----------|--------------------------|--------------------------|----------|
| indexer   | 2025-06-19 08:15:36.297000 | 2025-06-19 08:15:36.541000 | 0:00:00.244 |
| persist   | 2025-06-19 08:15:36.542000 | 2025-06-19 08:15:36.730000 | 0:00:00.188 |
| analysis  | 2025-06-19 08:15:36.830000 | 2025-06-19 08:15:37.337000 | 0:00:00.507 |
| ca        | 2025-06-19 08:15:37.345000 | 2025-06-19 08:16:13.503000 | 0:00:36.158 |
| exposure  | 2025-06-19 08:15:37.405000 | 2025-06-19 08:16:13.197000 | 0:00:35.792 |
# Trace ID: 280a4d12ec79bd7e
| 阶段      | 起始时间                 | 结束时间                 | 耗时     |
|-----------|--------------------------|--------------------------|----------|
| indexer   | 2025-06-26 09:23:22.986000 | 2025-06-26 09:23:28.924000 | 0:00:05.937 |
| persist   | 2025-06-26 09:23:28.946000 | 2025-06-26 09:23:29.626000 | 0:00:00.680 |
| analysis  | 2025-06-26 09:23:29.729000 | 2025-06-26 09:23:30.316000 | 0:00:00.587 |
| ca        | 2025-06-26 09:23:30.325000 | 2025-06-26 09:23:30.335000 | 0:00:00.010 |
| exposure  | --------------------- | --------------------- |          |
```

## 适用场景

- Xray 支持包性能分析
- trace id 级别的流程追踪
- 阶段耗时统计与瓶颈定位

---

